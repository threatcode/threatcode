{%- set logrotate_conf = salt['pillar.get']('logrotate:conf') %}
{%- set group_conf = salt['pillar.get']('logrotate:group_conf') %}


/opt/tc/log/aptcacher-ng/*.log
/opt/tc/log/idstools/*.log
/opt/tc/log/nginx/*.log
/opt/tc/log/soc/*.log
/opt/tc/log/kratos/*.log
/opt/tc/log/kibana/*.log
/opt/tc/log/influxdb/*.log
/opt/tc/log/elastalert/*.log
/opt/tc/log/soctopus/*.log
/opt/tc/log/curator/*.log
/opt/tc/log/fleet/*.log
/opt/tc/log/suricata/*.log
/opt/tc/log/mysql/*.log
/opt/tc/log/telegraf/*.log
/opt/tc/log/redis/*.log
/opt/tc/log/sensoroni/*.log
/opt/tc/log/stenographer/*.log
/opt/tc/log/salt/tc-salt-minion-check
/opt/tc/log/salt/minion
/opt/tc/log/salt/master
/opt/tc/log/logscan/*.log
/nsm/idh/*.log
{
    {{ logrotate_conf | indent(width=4) }}
}

# Playbook's log directory needs additional configuration
# because Playbook requires a more permissive directory
/opt/tc/log/playbook/*.log
{
    {{ logrotate_conf | indent(width=4) }}
    {{ group_conf | indent(width=4) }}
}
